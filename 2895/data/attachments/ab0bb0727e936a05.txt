[32mINFO    [0m pytest_operator.plugin:plugin.py:734 Connecting to existing model localhost-localhost:test on unspecified cloud
[32mINFO    [0m juju.model:model.py:2097 Deploying local:jammy/opensearch-0
[32mINFO    [0m juju.model:model.py:2097 Deploying ch:amd64/jammy/manual-tls-certificates-108
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:329 



[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:330 Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.5.3    unsupported  02:02:25Z

App                      Version  Status   Scale  Charm                    Channel        Rev  Exposed  Message
manual-tls-certificates           waiting    0/1  manual-tls-certificates  latest/stable  108  no       waiting for machine
opensearch                        waiting    0/3  opensearch                                0  no       waiting for machine

Unit                       Workload  Agent       Machine  Public address  Ports  Message
manual-tls-certificates/0  waiting   allocating  3                               waiting for machine
opensearch/0               waiting   allocating  0                               waiting for machine
opensearch/1               waiting   allocating  1                               waiting for machine
opensearch/2               waiting   allocating  2                               waiting for machine

Machine  State    Address  Inst id  Base          AZ  Message
0        pending           pending  ubuntu@22.04      Creating container
1        pending           pending  ubuntu@22.04      Creating container
2        pending           pending  ubuntu@22.04      Creating container
3        pending           pending  ubuntu@22.04      Creating container

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:02:25 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: manual-tls-certificates - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:02:36 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: manual-tls-certificates - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:02:47 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:348 02:04:51 -- Waiting for model: complete.



[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:44 Deployed manual-tls-certificates application
[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:48 Integrated opensearch with manual-tls-certificates
[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:54 Waiting for CSRs to be created
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:58 Signing CSRs
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/0
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/0
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/0
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/0
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/0
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/0
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/1
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/1
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/1
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/1
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/2
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/2
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/2
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/2
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:329 



[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:330 Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.5.3    unsupported  02:06:07Z

App                      Version  Status       Scale  Charm                    Channel        Rev  Exposed  Message
manual-tls-certificates           active           1  manual-tls-certificates  latest/stable  108  no       No outstanding requests.
opensearch                        maintenance      3  opensearch                                0  no       Waiting for TLS to be fully configured...

Unit                        Workload     Agent      Machine  Public address  Ports  Message
manual-tls-certificates/0*  active       idle       3        10.22.45.37            No outstanding requests.
opensearch/0*               maintenance  executing  0        10.22.45.96            Waiting for TLS to be fully configured...
opensearch/1                maintenance  executing  1        10.22.45.189           Waiting for TLS to be fully configured...
opensearch/2                maintenance  executing  2        10.22.45.45            Waiting for TLS to be fully configured...

Machine  State    Address       Inst id        Base          AZ  Message
0        started  10.22.45.96   juju-6d68f4-0  ubuntu@22.04      Running
1        started  10.22.45.189  juju-6d68f4-1  ubuntu@22.04      Running
2        started  10.22.45.45   juju-6d68f4-2  ubuntu@22.04      Running
3        started  10.22.45.37   juju-6d68f4-3  ubuntu@22.04      Running

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:06:07 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch maintenance -- message: Waiting for TLS to be fully configured...
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:06:07)] maintenance: Waiting for TLS to be fully configured...
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:06:05)] maintenance: Waiting for TLS to be fully configured...
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:06:07)] maintenance: Waiting for TLS to be fully configured...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:06:20 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch waiting -- message: Waiting for OpenSearch to start...
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:06:10)] waiting: Waiting for OpenSearch to start...
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:06:20)] waiting: Requesting lock on operation: start
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:06:19)] waiting: Requesting lock on operation: start

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:06:32 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch waiting -- message: Requesting lock on operation: start
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:06:32)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:06:31)] waiting: Requesting lock on operation: start
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:06:31)] waiting: Requesting lock on operation: start

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:06:43 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch waiting -- message: Requesting lock on operation: start
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:06:43)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:06:42)] waiting: Requesting lock on operation: start
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:06:41)] waiting: Waiting for OpenSearch to start...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:06:55 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch waiting -- message: Requesting lock on operation: start
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:06:47)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:06:46)] waiting: Requesting lock on operation: start
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:06:41)] waiting: Waiting for OpenSearch to start...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:07:07 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch waiting -- message: Waiting for OpenSearch to start...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:04)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:06:59)] waiting: Waiting for OpenSearch to start...
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:04)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:07:18 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:261 	App: opensearch - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:262 
	app: opensearch waiting -- message: Waiting for OpenSearch to start...
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:07:18)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:07:17)] waiting: Waiting for OpenSearch to start...
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:07:18)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:07:31 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch active -- message: None
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:07:42 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch active -- message: None
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:07:54 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:348 02:07:55 -- Waiting for model: complete.



[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:72 Scaling up the application by adding a new unit
[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:76 Waiting for the new unit to be in maintenance waiting for certificates
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:329 



[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:330 Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.5.3    unsupported  02:07:55Z

App                      Version  Status   Scale  Charm                    Channel        Rev  Exposed  Message
manual-tls-certificates           active       1  manual-tls-certificates  latest/stable  108  no       No outstanding requests.
opensearch                        waiting    3/4  opensearch                                0  no       waiting for machine

Unit                        Workload  Agent       Machine  Public address  Ports     Message
manual-tls-certificates/0*  active    idle        3        10.22.45.37               No outstanding requests.
opensearch/0*               active    idle        0        10.22.45.96     9200/tcp  
opensearch/1                active    idle        1        10.22.45.189    9200/tcp  
opensearch/2                active    idle        2        10.22.45.45     9200/tcp  
opensearch/3                waiting   allocating  4                                  waiting for machine

Machine  State    Address       Inst id        Base          AZ  Message
0        started  10.22.45.96   juju-6d68f4-0  ubuntu@22.04      Running
1        started  10.22.45.189  juju-6d68f4-1  ubuntu@22.04      Running
2        started  10.22.45.45   juju-6d68f4-2  ubuntu@22.04      Running
3        started  10.22.45.37   juju-6d68f4-3  ubuntu@22.04      Running
4        pending                pending        ubuntu@22.04      Creating container

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:07:55 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:251 opensearch -- expected units: 4 -- current: 3
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:08:07 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch waiting -- message: waiting for machine
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [allocating (since: 02:07:55)] waiting: waiting for machine

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:09:22 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Installing OpenSearch...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:09:21)] maintenance: Installing OpenSearch...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:09:35 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Installing OpenSearch...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:09:21)] maintenance: Installing OpenSearch...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:09:47 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Installing OpenSearch...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:09:21)] maintenance: Installing OpenSearch...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:09:59 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Installing OpenSearch...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:09:21)] maintenance: Installing OpenSearch...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:10:11 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Installing OpenSearch...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:07:24)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:07:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:07:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:09:21)] maintenance: Installing OpenSearch...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:10:23 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch active -- message: None
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:10:23)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:10:23)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:10:23)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:10:23)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:10:36 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Waiting for TLS to be fully configured...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:10:28)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:10:25)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:10:25)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:10:36)] maintenance: Waiting for TLS to be fully configured...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:10:48 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Waiting for TLS to be fully configured...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:10:28)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:10:25)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:10:25)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [idle (since: 02:10:47)] maintenance: Waiting for TLS to be fully configured...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:11:00 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Waiting for TLS to be fully configured...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:10:28)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:10:25)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:10:25)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [idle (since: 02:10:47)] maintenance: Waiting for TLS to be fully configured...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:11:12 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Waiting for TLS to be fully configured...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:10:28)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:10:25)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:10:25)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [idle (since: 02:10:47)] maintenance: Waiting for TLS to be fully configured...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:11:24 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:348 02:11:27 -- Waiting for model: complete.



[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:85 Waiting for the new unit to request certificates
[32mINFO    [0m root:helpers_manual_tls.py:93 Getting outstanding certificate requests
[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:89 Signing CSRs
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/3
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/3
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:147 Generated certificate for opensearch/3
[32mINFO    [0m integration.tls.helpers_manual_tls:helpers_manual_tls.py:165 Provided certificate to opensearch/3
[32mINFO    [0m integration.tls.test_manual_tls:test_manual_tls.py:93 Waiting for the new unit to be active
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:329 



[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:330 Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.5.3    unsupported  02:11:30Z

App                      Version  Status       Scale  Charm                    Channel        Rev  Exposed  Message
manual-tls-certificates           active           1  manual-tls-certificates  latest/stable  108  no       No outstanding requests.
opensearch                        maintenance      4  opensearch                                0  no       Waiting for TLS to be fully configured...

Unit                        Workload     Agent      Machine  Public address  Ports     Message
manual-tls-certificates/0*  active       idle       3        10.22.45.37               No outstanding requests.
opensearch/0*               active       executing  0        10.22.45.96     9200/tcp  
opensearch/1                active       executing  1        10.22.45.189    9200/tcp  
opensearch/2                active       executing  2        10.22.45.45     9200/tcp  
opensearch/3                maintenance  executing  4        10.22.45.135              Waiting for TLS to be fully configured...

Machine  State    Address       Inst id        Base          AZ  Message
0        started  10.22.45.96   juju-6d68f4-0  ubuntu@22.04      Running
1        started  10.22.45.189  juju-6d68f4-1  ubuntu@22.04      Running
2        started  10.22.45.45   juju-6d68f4-2  ubuntu@22.04      Running
3        started  10.22.45.37   juju-6d68f4-3  ubuntu@22.04      Running
4        started  10.22.45.135  juju-6d68f4-4  ubuntu@22.04      Running

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:11:30 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch maintenance -- message: Waiting for TLS to be fully configured...
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:11:29)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:11:29)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:11:29)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:11:29)] maintenance: Waiting for TLS to be fully configured...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:11:42 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch waiting -- message: Requesting lock on operation: start
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:11:42)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:11:42)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:11:42)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:11:40)] waiting: Requesting lock on operation: start

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:11:54 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch waiting -- message: Waiting for OpenSearch to start...
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:11:44)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:11:42)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:11:42)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:11:40)] waiting: Waiting for OpenSearch to start...

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:12:06 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch active -- message: None
		opensearch-0.679* -- (10.22.45.96) -- [executing (since: 02:12:07)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [executing (since: 02:12:06)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [executing (since: 02:12:06)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [executing (since: 02:12:06)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:12:18 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch active -- message: None
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:12:09)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:12:08)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:12:08)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [idle (since: 02:12:08)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:12:31 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:277 	App: opensearch - Units - conditions unmet.
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:278 
	app: opensearch active -- message: None
		opensearch-0.679* -- (10.22.45.96) -- [idle (since: 02:12:09)] active: 
		opensearch-1.679  -- (10.22.45.189) -- [idle (since: 02:12:08)] active: 
		opensearch-2.679  -- (10.22.45.45) -- [idle (since: 02:12:08)] active: 
		opensearch-3.679  -- (10.22.45.135) -- [idle (since: 02:12:08)] active: 

[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:337 


02:12:43 -- Waiting for model...
[32mINFO    [0m integration.helpers_deployments:helpers_deployments.py:348 02:12:45 -- Waiting for model: complete.
[32mINFO    [0m pytest_operator.plugin:plugin.py:862 Model status:

Model  Controller           Cloud/Region         Version  SLA          Timestamp
test   localhost-localhost  localhost/localhost  3.5.3    unsupported  02:12:45Z

App                      Version  Status  Scale  Charm                    Channel        Rev  Exposed  Message
manual-tls-certificates           active      1  manual-tls-certificates  latest/stable  108  no       No outstanding requests.
opensearch                        active      4  opensearch                                0  no       

Unit                        Workload  Agent  Machine  Public address  Ports     Message
manual-tls-certificates/0*  active    idle   3        10.22.45.37               No outstanding requests.
opensearch/0*               active    idle   0        10.22.45.96     9200/tcp  
opensearch/1                active    idle   1        10.22.45.189    9200/tcp  
opensearch/2                active    idle   2        10.22.45.45     9200/tcp  
opensearch/3                active    idle   4        10.22.45.135    9200/tcp  

Machine  State    Address       Inst id        Base          AZ  Message
0        started  10.22.45.96   juju-6d68f4-0  ubuntu@22.04      Running
1        started  10.22.45.189  juju-6d68f4-1  ubuntu@22.04      Running
2        started  10.22.45.45   juju-6d68f4-2  ubuntu@22.04      Running
3        started  10.22.45.37   juju-6d68f4-3  ubuntu@22.04      Running
4        started  10.22.45.135  juju-6d68f4-4  ubuntu@22.04      Running

[32mINFO    [0m pytest_operator.plugin:plugin.py:868 Juju error logs:

machine-0: 02:04:00 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-0: 02:04:00 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-opensearch-0: 02:04:00 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-2: 02:04:01 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-3: 02:04:01 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-2: 02:04:01 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-3: 02:04:01 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-opensearch-2: 02:04:01 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-manual-tls-certificates-0: 02:04:01 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-1: 02:04:02 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-1: 02:04:02 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-opensearch-1: 02:04:03 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-opensearch-1: 02:05:45 ERROR unit.opensearch/1.juju-log certificates:3: Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/model.py", line 3187, in _run
    result = subprocess.run(args, **kwargs)  # type: ignore
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '('/var/lib/juju/tools/unit-opensearch-1/secret-get', '--label', 'opensearch:app:app-admin', '--format=json')' returned non-zero exit status 1.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-opensearch-1/charm/./src/charm.py", line 213, in <module>
    main(OpenSearchOperatorCharm)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/main.py", line 551, in main
    manager.run()
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/main.py", line 530, in run
    self._emit()
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/main.py", line 516, in _emit
    self.framework.reemit()
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/framework.py", line 870, in reemit
    self._reemit()
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/framework.py", line 950, in _reemit
    custom_handler(event)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/lib/charms/opensearch/v0/opensearch_tls.py", line 163, in _on_tls_relation_created
    admin_cert = self.charm.secrets.get_object(Scope.APP, CertType.APP_ADMIN.val) or {}
  File "/var/lib/juju/agents/unit-opensearch-1/charm/lib/charms/opensearch/v0/opensearch_secrets.py", line 330, in get_object
    return self._get_juju_secret_content(scope, key)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/lib/charms/opensearch/v0/opensearch_secrets.py", line 209, in _get_juju_secret_content
    secret = self._get_juju_secret(scope, key)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/lib/charms/opensearch/v0/opensearch_secrets.py", line 197, in _get_juju_secret
    secret = self._charm.model.get_secret(label=label)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/model.py", line 291, in get_secret
    content = self._backend.secret_get(id=id, label=label)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/model.py", line 3552, in secret_get
    result = self._run('secret-get', *args, return_output=True, use_json=True)
  File "/var/lib/juju/agents/unit-opensearch-1/charm/venv/ops/model.py", line 3189, in _run
    raise ModelError(e.stderr) from e
ops.model.ModelError: ERROR permission denied

unit-opensearch-1: 02:05:45 ERROR juju.worker.uniter.operation hook "certificates-relation-joined" (via hook dispatching script: dispatch) failed: exit status 1
unit-opensearch-0: 02:06:02 ERROR unit.opensearch/0.juju-log certificates:3: err:  / out: keytool error: java.lang.Exception: Keystore file does not exist: /var/snap/opensearch/current/etc/opensearch/certificates/ca.p12

unit-opensearch-1: 02:06:07 ERROR unit.opensearch/1.juju-log certificates:3: err:  / out: keytool error: java.lang.Exception: Keystore file does not exist: /var/snap/opensearch/current/etc/opensearch/certificates/ca.p12

unit-opensearch-0: 02:06:10 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:11 ERROR unit.opensearch/2.juju-log certificates:3: err:  / out: keytool error: java.lang.Exception: Keystore file does not exist: /var/snap/opensearch/current/etc/opensearch/certificates/ca.p12

unit-opensearch-0: 02:06:11 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-0: 02:06:11 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-0: 02:06:12 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:14 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:15 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-0: 02:06:15 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:15 ERROR unit.opensearch/2.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:15 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:16 ERROR unit.opensearch/2.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:16 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:17 ERROR unit.opensearch/2.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:17 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-0: 02:06:18 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:18 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:18 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:19 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:19 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:20 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:20 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:21 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:21 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-0: 02:06:21 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:21 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:21 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:22 ERROR unit.opensearch/1.juju-log certificates:3: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:22 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-0: 02:06:24 ERROR unit.opensearch/0.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:24 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:25 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:26 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:27 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:28 ERROR unit.opensearch/2.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:28 ERROR unit.opensearch/1.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:29 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:29 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:29 ERROR unit.opensearch/2.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:30 ERROR unit.opensearch/1.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:31 ERROR unit.opensearch/2.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:31 ERROR unit.opensearch/1.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:32 ERROR unit.opensearch/2.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:32 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:33 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:34 ERROR unit.opensearch/1.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:34 ERROR unit.opensearch/2.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:34 ERROR unit.opensearch/1.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:42 ERROR unit.opensearch/1.juju-log upgrade-version-a:2: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:42 ERROR unit.opensearch/2.juju-log upgrade-version-a:2: Cannot connect to the OpenSearch server...
unit-opensearch-2: 02:06:43 ERROR unit.opensearch/2.juju-log upgrade-version-a:2: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:43 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:44 ERROR unit.opensearch/1.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:45 ERROR unit.opensearch/1.juju-log opensearch-peers:0: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:06:59 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
unit-opensearch-1: 02:07:01 ERROR unit.opensearch/1.juju-log node-lock-fallback:1: Cannot connect to the OpenSearch server...
machine-4: 02:09:07 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-4: 02:09:07 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-opensearch-3: 02:09:07 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-opensearch-3: 02:11:31 ERROR unit.opensearch/3.juju-log certificates:3: err:  / out: keytool error: java.lang.Exception: Keystore file does not exist: /var/snap/opensearch/current/etc/opensearch/certificates/ca.p12

unit-opensearch-3: 02:11:41 ERROR unit.opensearch/3.juju-log Cannot connect to the OpenSearch server...
unit-opensearch-3: 02:11:44 ERROR unit.opensearch/3.juju-log Cannot connect to the OpenSearch server...

[32mINFO    [0m pytest_operator.plugin:plugin.py:947 Forgetting model main...