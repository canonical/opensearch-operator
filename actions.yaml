# Copyright 2023 Canonical Ltd.
# See LICENSE file for licensing details.

set-tls-private-key:
  description: Set the private keys, which will be used for certificate signing requests (CSR). Run for each unit separately or on-leader only depending on the type.
  params:
    category:
      type: string
      enum:
        - "app-admin"
        - "unit-transport"
        - "unit-http"
      description: (Required) Type of private key to be set. "app-admin" must only be set on the leader.
    key:
      type: string
      description: (Optional) The content of the private key. The content will be auto-generated if not set.
    password:
      type: string
      description: (Optional) The passphrase of the private key. Will NOT be set if omitted.
  required:
    - category

set-password:
  description: Change the admin user's password, which is used by charm. It is for internal charm users and SHOULD NOT be used by applications.
  params:
    username:
      type: string
      description: The username, the default value 'admin'. Possible values - admin.
      default: admin
    password:
      type: string
      description: The password will be auto-generated if this option is not set.

get-password:
  description: Fetch the system user's password and CA chain, which is used by charm. It is for internal charm users and SHOULD NOT be used by applications.
  params:
    username:
      type: string
      description: The username, the default value 'admin'. Possible values - admin.
      default: admin

create-backup:
  description: Create a database backup.
    S3 credentials are retrieved from a relation with the S3 integrator charm.
  indices:
      type: string
      default: "*,-.opensearch-security"
      description: |
        OPTIONAL, use this option to specify a subset of indices to restore
        More info: https://opensearch.org/docs/latest/tuning-your-cluster/availability-and-recovery/snapshots/snapshot-restore/#restore-snapshots

get-backup-status:
  description: Check the status of the backup plugin

list-backups:
  description: List available backup_ids in the S3 bucket and path provided by the S3 integrator charm.

restore:
  description: | 
    Restore a database backup.
    S3 credentials are retrieved from a relation with the S3 integrator charm.
  params:
    backup-id:
      type: string
      description: A backup-id to identify the backup to restore
    indices:
      type: string
      default: "*,-.opensearch-security"
      description: |
        OPTIONAL, use this option to specify a subset of indices to restore
        More info: https://opensearch.org/docs/latest/tuning-your-cluster/availability-and-recovery/snapshots/snapshot-restore/#restore-snapshots
    rename-pattern:
      type: string
      default: ""
      description: |
        OPTIONAL, use this option to specify a regex that matches all indices you want to restore.
        More info: https://opensearch.org/docs/latest/tuning-your-cluster/availability-and-recovery/snapshots/snapshot-restore/#restore-snapshots
    rename-replacement:
      type: string
      default: ""
      description: |
        OPTIONAL, use this option to rename indices as they get restored
        More info: https://opensearch.org/docs/latest/tuning-your-cluster/availability-and-recovery/snapshots/snapshot-restore/#restore-snapshots
    index-settings:
      type: string
      default: ""
      description: |
        OPTIONAL, use this option to change settings of the index, you cannot change shard.
        More info: https://opensearch.org/docs/latest/tuning-your-cluster/availability-and-recovery/snapshots/snapshot-restore/#restore-snapshots
    ignore-index-settings:
      type: string
      default: ""
      description: |
        OPTIONAL, use this option to ignore certain settings in the index-settings option.
        More info: https://opensearch.org/docs/latest/tuning-your-cluster/availability-and-recovery/snapshots/snapshot-restore/#restore-snapshots      
  required:
    - backup-id